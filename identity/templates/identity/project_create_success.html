{% extends "vault/base.html" %}
{% load i18n static %}

{% block title %}{% trans 'Project Created' %}{% endblock %}
{% block content_title %}{% trans 'Project Created' %}{% endblock %}

{% block css %}
  <link rel="stylesheet" type="text/css" href="{% static 'identity/css/project.css' %}" />
{% endblock %}

{% block content %}
  <h4>
    <i class="icon-warning fa fa-warning"></i>
    {% trans 'Save this information to access the services' %}
  </h4>
  <br />

  <div class="vault-table-container" id="credentials">
    <table class="project-created items-list table table-striped">
      <caption>{% trans 'Credentials' %}</caption>
      <tr>
        <th width="20%">{% trans 'Project' %}</th>
        <td>{{ project_info.project_name }}</td>
      </tr>
      <tr>
        <th>{% trans 'Username' %}</th>
        <td>{{ project_info.user_name }}</td>
      </tr>
      <tr>
        <th>{% trans 'Password' %}</th>
        <td>{{ project_info.user_password }}</td>
      </tr>
      <tr>
        <th>Auth URL</th>
        <td>{{ project_info.auth_url }}</td>
      </tr>
    </table>
  </div>
  <div class="card">
    <div class="card-body">
      <button class="btn btn-info btn-copy-clipboard" data-copied-msg="{% trans 'Copied!' %}" id="btn-copy-clipboard">
        {% trans 'Copy to Clipboard' %}
      </button>
      <button class="btn btn-info btn-download" id="btn-download">
        {% trans 'Download Credentials' %}
      </button>
    </div>
  </div>

  <div class="vault-table-container">
    <table class="project-created items-list table table-bordered table-striped">
      <caption>S3/Swift endpoints</caption>
      <tr>
        <th width="20%">Admin URL</th>
        <td>{{ project_info.endpoints.object_store.adminURL }}</td>
      </tr>
      <tr>
        <th>Public URL</th>
        <td>{{project_info.endpoints.object_store.publicURL }}</td>
      </tr>
      <tr>
        <th>Internal URL</th>
        <td>{{ project_info.endpoints.object_store.internalURL }}</td>
      </tr>
    </table>
  </div>
{% endblock %}

{% block js_bottom %}
<script type="text/javascript">
  var jsonData = JSON.stringify({
    "project": "{{ project_info.project_name }}",
    "username": "{{ project_info.user_name }}",
    "password": "{{ project_info.user_password }}",
    "auth_url": "{{ project_info.auth_url }}"
  });
  var btnClipboard = document.getElementById('btn-copy-clipboard');
  var btnDownload = document.getElementById('btn-download');
  var copiedMsg = btnClipboard.dataset.copiedMsg;
  var clipboard = new Clipboard('.btn-copy-clipboard', {
      text: function(trigger) { return jsonData; }
  });

  clipboard.on('success', function(e) {
      Base.Messages.setMessage({ description: copiedMsg, type: 'success' });
      e.clearSelection();
  });

  btnDownload.onclick = () => {
      Base.Download.json('credentials.json', jsonData);
  }
</script>
{% endblock %}
